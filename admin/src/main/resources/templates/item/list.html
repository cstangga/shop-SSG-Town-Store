<!DOCTYPE html>
<html xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" xmlns:th="http://www.thymeleaf.org"
      layout:decorate="~{layout/default}">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <link rel="icon" href="/assets/images/favicon.png" type="image/x-icon">
        <link rel="shortcut icon" href="/assets/images/favicon.png" type="image/x-icon">
        <title>상품관리</title>
        <!-- Google font-->
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
        <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@200;300;400;500;600;700;800&amp;display=swap"
              rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="/assets/css/font-awesome.css">
        <!-- ico-font-->
        <link rel="stylesheet" type="text/css" href="/assets/css/vendors/icofont.css">
        <!-- Themify icon-->
        <link rel="stylesheet" type="text/css" href="/assets/css/vendors/themify.css">
        <!-- Flag icon-->
        <link rel="stylesheet" type="text/css" href="/assets/css/vendors/flag-icon.css">
        <!-- Feather icon-->
        <link rel="stylesheet" type="text/css" href="/assets/css/vendors/feather-icon.css">
        <!-- Plugins css start-->
        <link rel="stylesheet" type="text/css" href="/assets/css/vendors/slick.css">
        <link rel="stylesheet" type="text/css" href="/assets/css/vendors/slick-theme.css">
        <link rel="stylesheet" type="text/css" href="/assets/css/vendors/scrollbar.css">
        <link rel="stylesheet" type="text/css" href="/assets/css/vendors/animate.css">
        <link rel="stylesheet" type="text/css" href="/assets/css/vendors/js-datatables/style.css">
        <link rel="stylesheet" type="text/css" href="/assets/css/vendors/owlcarousel.css">
        <!-- Plugins css Ends-->
        <!-- Bootstrap css-->
        <link rel="stylesheet" type="text/css" href="/assets/css/vendors/bootstrap.css">
        <!-- App css-->
        <link rel="stylesheet" type="text/css" href="/assets/css/style.css">
        <link id="color" rel="stylesheet" href="/assets/css/color-1.css" media="screen">
        <!-- Responsive css-->
        <link rel="stylesheet" type="text/css" href="/assets/css/responsive.css">
        <script>
            const message = `[[${message}]]`;
            message && alert(message);
        </script>
    </head>
    <body>
                <!-- Page Sidebar Ends-->
                <div layout:fragment="main" class="page-body">
                    <div class="container-fluid">
                        <div class="page-title">
                            <div class="row">
                                <div class="col-6">
                                    <h4>상품 목록</h4>
                                </div>
                                <div class="col-6">
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Container-fluid starts-->
                    <div class="container-fluid">
                        <div class="row">
                            <div class="col-sm-12">
                                <div class="card">
                                    <div class="card-body">
                                        <div class="list-product-header">
                                            <div>
                                                <div class="light-box"><a data-bs-toggle="collapse" href="#collapseProduct"
                                                                          role="button" aria-expanded="false"
                                                                          aria-controls="collapseProduct"><i
                                                        class="filter-icon show" data-feather="filter"></i><i
                                                        class="icon-close filter-close hide"></i></a></div>
                                                <a class="btn btn-primary" th:href="@{/item/create}"><i class="fa fa-plus"></i>상품
                                                    등록</a>
                                            </div>
                                            <!-- 희윤 시작 -->
                                            <form name="MultiCondition" method="get">
                                                <div class="collapse" id="collapseProduct">
                                                    <div class="card card-body list-product-body">
                                                        <div class="row row-cols-xl-5 row-cols-lg-4 row-cols-md-3 row-cols-sm-2 row-cols-2 g-3">
                                                            <div class="col">
                                                                <select class="form-select" aria-label="Default select example" name="categoryName">
                                                                    <option selected value="">카테고리</option>
                                                                    <option th:each="categoryValue : ${T(com.sh.admin.item.model.dto.Category).values()}"
                                                                            th:value="${categoryValue.name()}"
                                                                            th:text="${categoryValue.name()}">
                                                                    </option>
                                                                </select>
        <!--                                                        <select class="form-select" aria-label="Default select example" th:field="*{category}">-->
        <!--                                                            <option selected value="">카테고리</option>-->
        <!--                                                            <option th:each="category : ${T(com.sh.admin.item.model.dto.Category).values()}"-->
        <!--                                                                    th:value="${category.name()}"-->
        <!--                                                                    th:text="${category.name()}">-->
        <!--                                                            </option>-->
        <!--                                                        </select>-->
                                                            </div>
                                                            <div class="col">
        <!--                                                        [[${param.artistName}]]-->
                                                                <select class="form-select" aria-label="Default select example" name="artistName">
                                                                    <option value="">아티스트</option>
                                                                    <option th:each="artistValue : ${T(com.sh.admin.item.model.dto.Artist).values()}"
                                                                            th:value="${artistValue.name()}"
                                                                            th:text="${artistValue.name()}">
                                                                    </option>
                                                                </select>
                                                            </div>
                                                            <div class="col">
                                                                <select class="form-select" aria-label="Default select example" name="saleStatus">
                                                                    <option selected value="">판매상태</option>
                                                                    <option th:each="saleStatusValue : ${T(com.sh.admin.item.model.dto.SaleStatus).values()}"
                                                                            th:value="${saleStatusValue.name()}"
                                                                            th:text="${saleStatusValue.name()}">
                                                                    </option>
                                                                </select>
                                                            </div>
                                                            <div class="col">
                                                                <select class="form-select" aria-label="Default select example" name="salePrice">
                                                                    <option selected value="0">가격</option>
                                                                    <option>10000</option>
                                                                    <option>30000</option>
                                                                    <option>50000</option>
                                                                    <option>100000</option>
                                                                </select>
                                                            </div>
                                                            <div>
                                                                <input type="submit" value="검색" class="btn btn-light">
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </form>
                                           <!-- 희윤 끝 -->
                                        </div>
                                        <div class="list-product">
                                            <table class="table" id="project-status">
                                                <thead>
                                                <tr>
                                                    <th>
                                                        <div class="form-check">
                                                            <input class="form-check-input checkbox-primary" type="checkbox">
                                                        </div>
                                                    </th>
                                                    <th><span class="f-light f-w-600">상품명</span></th>
                                                    <th><span class="f-light f-w-600">상품코드</span></th>
                                                    <th><span class="f-light f-w-600">카테고리</span></th>
                                                    <th><span class="f-light f-w-600">아티스트</span></th>
                                                    <th><span class="f-light f-w-600">판매원</span></th>
                                                    <th><span class="f-light f-w-600">세부설명</span></th>
                                                    <th><span class="f-light f-w-600">가격</span></th>
                                                    <th><span class="f-light f-w-600">수량</span></th>
                                                    <th><span class="f-light f-w-600">상태</span></th>
                                                    <th><span class="f-light f-w-600">Action</span></th>
                                                </tr>
                                                </thead>
                                                <tbody>
                                                <tr th:each="item, stat : ${items}" th:object="${item}" class="product-removes">
                                                    <td>
                                                        <div class="form-check">
                                                            <input class="form-check-input checkbox-primary" type="checkbox">
                                                        </div>
                                                    </td>
                                                    <td>
                                                        <div class="product-names">
                                                            <div class="light-product-box">
                                                                <img class="img-fluid" th:src="|@{/}${item.imgUrl}|"
                                                                     alt="Product Image">
                                                            </div>
                                                            <p th:text="*{itemName}"></p>
                                                        </div>
                                                    </td>
                                                    <td>
                                                        <p class="f-light" th:text="*{itemId}"></p>
                                                    </td>
                                                    <td>
                                                        <p class="f-light" th:text="*{categoryName}"></p>
                                                    </td>
                                                    <td>
                                                        <p class="f-light" th:text="*{artistName}"></p>
                                                    </td>
                                                    <td>
                                                        <p class="f-light" th:text="*{seller}"></p>
                                                    </td>
                                                    <td>
                                                        <p class="f-light" th:text="*{details}"></p>
                                                    </td>
        <!--                                            나경작업시작-->
                                                    <td>
                                                        <p class="f-light"
                                                           th:text="*{#numbers.formatInteger(salePrice, 2, 'COMMA')}"></p>
                                                    </td>
        <!--                                            나경작업끝-->
                                                    <td>
                                                        <p class="f-light" th:text="*{quantity}"></p>
                                                    </td>
                                                    <td>
                                                        <!--                        <span th:text="*{saleStatus}"></span>-->
                                                        <span class="badge badge-light-secondary"
                                                              th:text="*{saleStatus}"></span>
                                                    </td>
                                                    <td>
                                                        <div class="product-action">
                                                            <a th:href="@{|/item/update/${item.itemId}|}">
                                                                <svg>
                                                                    <use href="/assets/svg/icon-sprite.svg#edit-content"></use>
                                                                </svg>
                                                            </a>+
        <!--                                                    나경작업시작-->
                                                            <a href="javascript:void(0);" th:onclick="|updateSaleStatus(${item.itemId});|">
                                                                <svg>
                                                                    <use href="/assets/svg/icon-sprite.svg#trash1"></use>
                                                                </svg>
                                                            </a>
                                                            <!--                                                    나경작업끝-->
                                                        </div>
                                                    </td>
                                                </tr>
                                                </tbody>
                                                <script>
                                                    function updateSaleStatus(itemId) {
                                                        fetch('/item/updateSaleStatus?itemId=' + itemId, {
                                                            method: 'POST'
                                                        })
                                                            .then(response => response.json())
                                                            .then(data => {
                                                                if (data == true) {
                                                                    alert("상태가 '판매중지'로 변경되었습니다.");
                                                                    window.location.href = '/item/list';
                                                                } else {
                                                                    alert("품절상태가 아닙니다.");
                                                                    window.location.href = '/item/list';
                                                                }
                                                            })
                                                            .catch(error => {
                                                                console.error('Error:', error);
                                                            });
                                                    }
                                                </script>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Container-fluid Ends-->
        <!-- latest jquery-->
        <script src="/assets/js/jquery.min.js"></script>
        <!-- Bootstrap js-->
        <script src="/assets/js/bootstrap/bootstrap.bundle.min.js"></script>
        <!-- feather icon js-->
        <script src="/assets/js/icons/feather-icon/feather.min.js"></script>
        <script src="/assets/js/icons/feather-icon/feather-icon.js"></script>
        <!-- scrollbar js-->
        <script src="/assets/js/scrollbar/simplebar.js"></script>
        <script src="/assets/js/scrollbar/custom.js"></script>
        <!-- Sidebar jquery-->
        <script src="/assets/js/config.js"></script>
        <!-- Plugins JS start-->
        <script src="/assets/js/sidebar-menu.js"></script>
        <script src="/assets/js/sidebar-pin.js"></script>
        <script src="/assets/js/slick/slick.min.js"></script>
        <script src="/assets/js/slick/slick.js"></script>
        <script src="/assets/js/header-slick.js"></script>
        <!-- calendar js-->
        <script src="/assets/js/js-datatables/simple-datatables@latest.js"></script>
        <script src="/assets/js/custom-list-product.js"></script>
        <script src="/assets/js/owlcarousel/owl.carousel.js"></script>
        <script src="/assets/js/ecommerce.js"></script>
        <script src="/assets/js/tooltip-init.js"></script>
        <!-- Plugins JS Ends-->
        <!-- Theme js-->
        <script src="/assets/js/script.js"></script>
    </div>
    </body>
</html>